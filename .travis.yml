language: c
compiler:
    - gcc
    - clang
before_install:
    - sudo apt-get update
    - sudo apt-get -y install pkg-config libglib2.0-0 libglib2.0-dev tree
script:
    - export CC="$CC" TEST_PREFIX="`pwd`/test_prefix"
    - source ./testsuite/travis-ci.bash
    - make DICDIR=./quotes WITH_TEST=1 test
    - make clean
    - install_bin "$CC" "$TEST_PREFIX"
    - cleanup "$TEST_PREFIX"
    - install_quotes "$CC" "$TEST_PREFIX"
    - cleanup "$TEST_PREFIX"
    - install_man "$CC" "$TEST_PREFIX"
    - cleanup "$TEST_PREFIX"
    - install_doc "$CC" "$TEST_PREFIX"
    - cleanup "$TEST_PREFIX"
    - install_zsh_compdef "$CC" "$TEST_PREFIX"
    - cleanup "$TEST_PREFIX"
    - install_all "$CC" "$TEST_PREFIX"
    - ${TEST_PREFIX}/bin/yasuna --version
    - ${TEST_PREFIX}/bin/yasuna --help
    - ${TEST_PREFIX}/bin/yasuna
    - random_test "$TEST_PREFIX"
    - rm -rf ${TEST_PREFIX}
    - unset TEST_PREFIX
